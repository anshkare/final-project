---
title: "Plots & Info"
---


---
title: "Kobe Model"
author: "Ansh Kare"
format: html
---


```{r include = FALSE, message=FALSE}
#| echo: false
library(tidyverse)
library(brms)
library(dplyr)
library(readr)

```


```{r include=FALSE, message=FALSE}
#| echo: false

kobe_data <- read_csv("kobebryant.csv")

kobe_data$game_type <- ifelse(kobe_data$game_type == "playoff", 1, 0)

names(kobe_data) <- gsub("^\\d", "var_", names(kobe_data))

kobe_data$assists <- as.numeric(kobe_data$assists)


kobe_data$fieldgoal_percent <- as.numeric(kobe_data$fieldgoal_percent)
kobe_data$point_difference <- as.numeric(kobe_data$point_difference)
kobe_data$turnovers <- as.numeric(kobe_data$turnovers)
kobe_data$season <- as.numeric(kobe_data$season)

kobe_data <- na.omit(kobe_data)

```

```{r include = FALSE, message=FALSE}
fit <- brm(
  formula = assists ~ age + turnovers + point_difference ,
  data = kobe_data,
  family = gaussian(),
  chains = 4,
  iter = 2000,
  warmup = 1000,
  silent =2,
  refresh = 0,
  seed = 9
)
# Obtain posterior predictions
preds <- posterior_predict(fit)

# Calculate the mean of the predictions
kobe_data$predicted_assists <- apply(preds, 2, mean)
```


```{r message=FALSE}

ggplot(kobe_data, aes(x = assists, y = predicted_assists)) +
  geom_point(aes(color = assists)) +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(x = "Actual Assists", y = "Predicted Assists",
       title = "Actual vs. Predicted Assists") +
  theme_minimal()
```
```{r message=FALSE}
# Create a new data frame with a range of 'age' values while holding others constant
age_range <- seq(min(kobe_data$age), max(kobe_data$age), length.out = 100)
predictor_data <- data.frame(
  age = age_range,
  turnovers = mean(kobe_data$turnovers),
  point_difference = mean(kobe_data$point_difference)
)

# Predict assists for these values
predictions <- fitted(fit, newdata = predictor_data, re_formula = NULL)
predictor_data$predicted_assists <- rowMeans(predictions)

# Plot
ggplot(predictor_data, aes(x = age, y = predicted_assists)) +
  geom_line(color = "blue") +
  labs(x = "Age", y = "Predicted Assists",
       title = "Effect of Age on Predicted Assists") +
  theme_minimal()
```


Many people have accused Kobe Bryant of being a ball-hog. I wanted to see what would statistically increase the chances of Kobe passing a ball in a given game. sing a dataset with each and every stat recorded of Kobe Bryant from the start of his career to his retirement, we seek to predict what will increase Kobe's likelihood of passing more in a game. We modeled assists as a linear function, with variables like Kobe's age, the amount of turnovers by Kobe, and the point_difference in a game. With each increase in point difference, Kobe is 3% more likely to pass the ball.  

